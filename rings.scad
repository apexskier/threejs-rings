// units in mm

Pi = 3.14159265359; // 4 * atan(1, 1);
camInnerRadius = 17.5;
aishaInnerRadius = 16.57;

// 100 wide
module mountains() {
    polygon(
        points =
        [
          [
            0.09614067197569988,
            20.110599670231725
          ],
          [
            100,
            19.587499484187425
          ],
          [
            99.90533545957403,
            1.5081034540661937
          ],
          [
            98.47381483915227,
            0.9475693215701695
          ],
          [
            97.68272623819821,
            0
          ],
          [
            96.43958652378834,
            0
          ],
          [
            95.38480172251627,
            0.45204998205009334
          ],
          [
            94.25467488064743,
            0.45204998205009334
          ],
          [
            93.38824423909658,
            1.0197574847749367
          ],
          [
            92.40880110171301,
            1.396354682797286
          ],
          [
            91.42935758762113,
            2.523945738983393
          ],
          [
            90.44991445023757,
            2.523945738983393
          ],
          [
            89.3197876083687,
            3.164349882035504
          ],
          [
            87.73761002975233,
            3.50338736953368
          ],
          [
            87.2102176291163,
            2.8629832264815693
          ],
          [
            86.3814578195097,
            2.2977742190829287
          ],
          [
            85.06297681791963,
            2.5992874028718767
          ],
          [
            83.93284997605079,
            2.5992874028718767
          ],
          [
            83.06641933449994,
            2.523945738983393
          ],
          [
            82.23765952489335,
            2.749970730648844
          ],
          [
            81.78560878814581,
            2.749970730648844
          ],
          [
            81.25821638750979,
            3.50338736953368
          ],
          [
            80.95684935524753,
            3.8047540326217812
          ],
          [
            80.35411491401472,
            3.5787290334221638
          ],
          [
            79.78905168143446,
            3.8047540326217812
          ],
          [
            79.3370009446869,
            4.0684498562314735
          ],
          [
            78.80960854405087,
            4.181462352064199
          ],
          [
            77.90550707055579,
            3.8047540326217812
          ],
          [
            76.81305106063118,
            3.654070697310648
          ],
          [
            76.0596332916214,
            4.0684498562314735
          ],
          [
            75.00484811364102,
            4.181462352064199
          ],
          [
            74.3267720085197,
            3.654070697310648
          ],
          [
            73.57335423950992,
            3.8047540326217812
          ],
          [
            72.85760730244436,
            3.2773623778682293
          ],
          [
            71.91583499700505,
            3.0513373862027784
          ],
          [
            71.50145509220175,
            2.749970730648844
          ],
          [
            70.89872065096891,
            1.7492889967059408
          ],
          [
            70.10763205001489,
            1.7603048445322376
          ],
          [
            69.76859380910007,
            1.508103593448272
          ],
          [
            69.16585974457556,
            1.1524215351538551
          ],
          [
            68.63846696723121,
            1.2196492145094544
          ],
          [
            68.22408743913624,
            1.6822396510687658
          ],
          [
            67.6213529979034,
            1.6822396510687658
          ],
          [
            67.16930226115586,
            1.396354682797286
          ],
          [
            66.49122615603454,
            1.2196492145094544
          ],
          [
            66.26520078766079,
            1.508103593448272
          ],
          [
            65.81315005091325,
            1.508103593448272
          ],
          [
            65.47411218670675,
            1.396354682797286
          ],
          [
            64.72069404098863,
            1.396354682797286
          ],
          [
            64.11795997646414,
            1.7492889967059408
          ],
          [
            63.477554703287055,
            2.0958836260333684
          ],
          [
            62.98783313459527,
            3.164349882035504
          ],
          [
            62.23441536558547,
            3.654070697310648
          ],
          [
            61.707022588241145,
            3.50338736953368
          ],
          [
            61.14195935566088,
            3.2773623778682293
          ],
          [
            60.689908618913336,
            3.2773623778682293
          ],
          [
            60.20018705022155,
            3.50338736953368
          ],
          [
            59.78580714541825,
            3.164349882035504
          ],
          [
            59.258414744782215,
            3.164349882035504
          ],
          [
            58.88170567192317,
            3.3903748737009547
          ],
          [
            58.3166424393429,
            3.654070697310648
          ],
          [
            57.86459170259537,
            3.50338736953368
          ],
          [
            57.48788262973631,
            3.5787290334221638
          ],
          [
            56.696793652073964,
            4.482829007618134
          ],
          [
            56.09405958754945,
            4.6711831673393425
          ],
          [
            55.3783126504839,
            4.482829007618134
          ],
          [
            54.66256571341833,
            4.558170671506617
          ],
          [
            54.28585664055928,
            4.746524831227827
          ],
          [
            53.7961350718675,
            4.897208159004793
          ],
          [
            52.96737526226091,
            4.59584150345086
          ],
          [
            52.13861582936262,
            3.654070697310648
          ],
          [
            51.46053972424131,
            3.654070697310648
          ],
          [
            50.48109621014943,
            3.2773623778682293
          ],
          [
            49.501653072765855,
            3.3903748737009547
          ],
          [
            48.71056447181183,
            3.164349882035504
          ],
          [
            47.88180466220522,
            3.654070697310648
          ],
          [
            47.09071606125119,
            3.8047540326217812
          ],
          [
            46.41263995612988,
            3.654070697310648
          ],
          [
            45.885247555493855,
            3.654070697310648
          ],
          [
            44.98114608199878,
            2.749970730648844
          ],
          [
            44.2653987682249,
            2.8629832264815693
          ],
          [
            43.47431016727087,
            3.50338736953368
          ],
          [
            42.49486702988729,
            3.50338736953368
          ],
          [
            41.7414492608775,
            3.0513373862027784
          ],
          [
            41.06337315575619,
            3.164349882035504
          ],
          [
            40.196942514205354,
            3.0513373862027784
          ],
          [
            39.820233441346296,
            3.2773623778682293
          ],
          [
            39.51886640908403,
            3.164349882035504
          ],
          [
            39.104486504280736,
            3.3903748737009547
          ],
          [
            38.84079030396274,
            3.654070697310648
          ],
          [
            38.087372534952934,
            3.8047540326217812
          ],
          [
            37.07025818891681,
            3.3903748737009547
          ],
          [
            35.67643514672994,
            2.8629832264815693
          ],
          [
            33.75521970390706,
            1.7492889967059408
          ],
          [
            33.227827303271035,
            1.2196492145094544
          ],
          [
            32.85111823041198,
            1.396354682797286
          ],
          [
            32.3613966617202,
            1.396354682797286
          ],
          [
            31.64564972465464,
            2.0958836260333684
          ],
          [
            30.44018084218899,
            2.2225790834294585
          ],
          [
            30.025801314094004,
            2.8629832264815693
          ],
          [
            28.971016136113644,
            3.164349882035504
          ],
          [
            28.78266159968411,
            3.654070697310648
          ],
          [
            28.142256326507038,
            3.8047540326217812
          ],
          [
            27.61486392587102,
            3.50338736953368
          ],
          [
            26.710762452375942,
            3.8047540326217812
          ],
          [
            25.73131931499237,
            3.8047540326217812
          ],
          [
            25.128584873759547,
            3.3903748737009547
          ],
          [
            24.563521641179282,
            2.8629832264815693
          ],
          [
            23.923116368002205,
            2.749970730648844
          ],
          [
            23.320381926769382,
            2.147237419540975
          ],
          [
            22.566964157759593,
            2.0342249237082495
          ],
          [
            22.11491342101205,
            1.8257929865798976
          ],
          [
            21.512179356487536,
            1.8835415959312825
          ],
          [
            21.32382482005801,
            2.2225790834294585
          ],
          [
            20.570407051048218,
            3.0513373862027784
          ],
          [
            20.005343441759635,
            2.5992874028718767
          ],
          [
            19.666305577553132,
            1.9588832598197659
          ],
          [
            19.289596504694074,
            1.8835415959312825
          ],
          [
            18.950558263779264,
            2.147237419540975
          ],
          [
            18.57384956762853,
            2.0342249237082495
          ],
          [
            18.084127998936747,
            1.7603048445322376
          ],
          [
            17.745089758021926,
            2.2225790834294585
          ],
          [
            17.368381061871187,
            2.2225790834294585
          ],
          [
            16.991671989012133,
            2.0342249237082495
          ],
          [
            16.72797578869412,
            1.6126808704957918
          ],
          [
            16.125241347461298,
            1.6822396510687658
          ],
          [
            15.748532651310562,
            2.147237419540975
          ],
          [
            14.769089137218675,
            3.164349882035504
          ],
          [
            13.940329704320398,
            3.164349882035504
          ],
          [
            13.111569894713796,
            2.523945738983393
          ],
          [
            11.529392316097402,
            1.0197574847749367
          ],
          [
            10.738303715143369,
            0.9475693215701695
          ],
          [
            9.909543905536774,
            0.6992122809419509
          ],
          [
            9.231467800415462,
            1.0197574847749367
          ],
          [
            8.779417176680413,
            0.9014351081267604
          ],
          [
            8.176682886130918,
            0.9014351081267604
          ],
          [
            7.265044119567933,
            0.9475693215701695
          ],
          [
            6.6547888097499355,
            1.1524215351538551
          ],
          [
            6.094013723311549,
            1.0197574847749367
          ],
          [
            5.11122304278892,
            1.0985191177439775
          ],
          [
            4.294800505985724,
            0.7307649139613812
          ],
          [
            3.3912498177245007,
            0.6992122809419509
          ],
          [
            2.705698614078832,
            0.9014351081267604
          ],
          [
            2.107275599562023,
            0.7674563683154871
          ],
          [
            1.5637706683576404,
            1.2196492145094544
          ],
          [
            0.8828208814922941,
            1.2901044478702055
          ],
          [
            0.6490450408126531,
            1.508103593448272
          ],
          [
            0,
            1.7492880926059742
          ]
        ]
        ,
        convexity = 10
    );
}

module mountainRing() {
    H = 8;
    R = camInnerRadius + 1.7;
    L = 100;
    step = 10;

    cubeSide = R * tan((1 / 2) * step) * 2;
    polySurfaceLen = cubeSide * (360 / step);

    scale([1, 1, 0.7]) {
        rotate(-90, [1, 0, 0]) {
            for (i = [0:step:360 - 1]) {
                rotate([0, i, 0]) {
                    translate([0, 0, R - H]) {
                        color([i / 360, 0, 0])
                        intersection() {
                            translate([polySurfaceLen - cubeSide * ((1 / 2) + (i / step)), 0, 0]) {
                                linear_extrude(height = H * 2, convexity = 4) {
                                    scale(.01 * polySurfaceLen) {
                                        translate([-100, 0, 0]) {
                                            mountains();
                                        }
                                    }
                                }
                            }

                            translate([0, 0, H/2])
                                cube([cubeSide, 100, H], center = true);  // window
                        }
                    }
                }
            }
        }
    }
}

// // cameron's ring
// intersection() {
//     difference() {
//         cylinder(h = 6, r1 = camInnerRadius + 1.7, r2 = camInnerRadius + 1.5, $fn = 100);
//         translate([0, 0, -1]) {
//             cylinder(h = 8, r1 = camInnerRadius, r2 = camInnerRadius, $fn = 100);
//         }
//     }
//
//     translate([0, 0, 6]) {
//         mountainRing();
//     }
// }
//
// aisha's ring
difference() {
    translate([0, 0, 10]) {
        difference() {
            cylinder(h = 6, r1 = aishaInnerRadius + 1.7, r2 = aishaInnerRadius + 1.7, $fn = 100);
            translate([0, 0, -1]) {
                cylinder(h = 8, r1 = aishaInnerRadius, r2 = aishaInnerRadius, $fn = 100);
            }
        }
    }

    translate([0, 0, 14.6]) {
        mountainRing();
    }
}
